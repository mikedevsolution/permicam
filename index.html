<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Permicam - Vérification</title>
    
    <style>
        /* ============================
           1. RESET & FOND
           ============================ */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f6f9; /* Fond gris pro */
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* ============================
           2. BANNIÈRE (HEADER - LOGO)
           ============================ */
        .header-banner {
            width: 100%;
            background-color: #fff;

        }
        
        .header-banner img {
            width: 100%;       /* Prend toute la largeur */
            height: auto;      /* Hauteur automatique pour garder les proportions */
            max-height: 200px; /* Limite la hauteur pour ne pas manger tout l'écran */
            object-fit: cover; /* IMPORTANT : Remplit le cadre sans déformer l'image */
            object-position: center; /* Centre l'image */
            display: block;
        }

        /* ============================
           3. LE CADRE PRINCIPAL
           ============================ */
        .main-container {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid #e1e1e1;
            border-radius: 4px;
            overflow: hidden;
            
            /* MARGES PAR DÉFAUT (Mobile) */
            width: 95%;
            margin: 20px auto;
        }

        /* RÈGLE SPÉCIFIQUE PC (Marge 15%) */
        @media (min-width: 992px) {
            .main-container {
                width: auto;       /* On laisse la largeur se calculer */
                margin-left: 15%;  /* 15% à gauche */
                margin-right: 15%; /* 15% à droite */
                margin-top: 30px;
                margin-bottom: 30px;
            }
        }

        /* Titre du panneau */
        .panel-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #e1e1e1;
        }
        .panel-header h2 {
            font-size: 1.1rem;
            text-transform: uppercase;
            color: #444;
            font-weight: 700;
            line-height: 1.4;
        }

        /* ============================
           4. LE TABLEAU
           ============================ */
        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin: 0;
        }

        /* Cellules */
        .info-table th, 
        .info-table td {
            padding: 12px 20px;
            border-bottom: 1px solid #e1e1e1;
            border-right: 1px solid #f0f0f0;
            vertical-align: middle;
        }

        /* Colonne Labels (Gauche) */
        .info-table th {
            width: 40%;
            background-color: #fcfcfc;
            color: #333;
            font-weight: 600;
            text-align: left;
        }

        /* Colonne Valeurs (Droite) */
        .info-table td {
            width: 60%;
            color: #000;
            font-weight: 600;
            background-color: #fff;
        }

        /* En-têtes de section */
        .section-header {
            background-color: #f8f9fa;
            color: #333;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.95rem;
            padding: 15px 20px;
            border-bottom: 1px solid #e1e1e1;
        }

        /* Gestion Photo */
        .photo-cell {
            text-align: center;
            padding: 20px !important;
        }
        .photo-cadre {
            display: inline-block;
            padding: 4px;
            border: 1px solid #ddd;
            background: #fff;
            border-radius: 4px;
        }
        #photo-permis {
            width: 120px;
            height: 150px;
            object-fit: cover;
            display: block;
            background-color: #eee;
        }

        /* ============================
           5. PIED DE PAGE (FOOTER)
           ============================ */
        .footer {
            margin-top: auto;      /* Pousse le footer tout en bas */
         
            
            /* Style demandé */
            text-align: right;     /* Aligné à droite */
            color: black;          /* Couleur noire */
            
            

        }

        @media (min-width: 992px) {
            .footer {
                padding-right: 15%; /* S'aligne avec le bord du cadre sur PC */
            }
        }

        /* ============================
           6. UTILITAIRES
           ============================ */
        .status-text { font-weight: bold; text-transform: uppercase; }
        .status-valid { color: #28a745; }
        .status-error { color: #dc3545; }
        .status-wait { color: #ffc107; }

        #loading { padding: 40px; text-align: center; color: #0056b3; font-weight: bold;}
        .hidden { display: none; }

        /* Responsive Mobile */
        @media (max-width: 600px) {
            .info-table th, .info-table td { padding: 10px; font-size: 0.9rem; }
            .info-table th { width: 35%; }
            .info-table td { width: 65%; }
        }
    </style>
</head>
<body>

    <div class="header-banner">
        <img src="Driver_brand_new_logo.jpg" alt="Ministère des Transports">
    </div>

    <div class="main-container">
        
        <div class="panel-header">
            <h2>Bienvenue sur le portail d'enrôlement à la demande de permis de conduire et badge</h2>
        </div>

        <div id="loading">Chargement des informations...</div>

        <div id="content" class="hidden">
            
            <table class="info-table">
                <tr>
                    <td colspan="2" class="section-header">Demande de Permis de Conduire</td>
                </tr>
                <tr>
                    <td colspan="2" class="section-header" style="background:white; border-bottom:1px solid #ddd; padding-top:5px; padding-bottom:5px;">Récapitulatif de la demande</td>
                </tr>
                <tr>
                    <th>Etat de la demande</th>
                    <td>
                        <span id="statut-demande" class="status-text">...</span>
                    </td>
                </tr>

                <tr>
                    <td colspan="2" class="section-header">Identité du détenteur</td>
                </tr>
                
                <tr>
                    <th>Photo</th>
                    <td class="photo-cell">
                        <div class="photo-cadre">
                            <img id="photo-permis" src="" alt="Photo">
                        </div>
                    </td>
                </tr>

                <tr>
                    <th>Nom</th>
                    <td id="nom"></td>
                </tr>
                <tr>
                    <th>Prénoms</th>
                    <td id="prenoms"></td>
                </tr>
                <tr>
                    <th>Date et Lieu de naissance</th>
                    <td>
                        <span id="date-naissance"></span> à <span id="lieu-naissance"></span>
                    </td>
                </tr>
                <tr>
                    <th>Genre</th>
                    <td id="genre"></td>
                </tr>
                <tr>
                    <th>Nationalité</th>
                    <td id="nationalite"></td>
                </tr>
                <tr>
                    <th>Numéro de permis</th>
                    <td id="num-permis"></td>
                </tr>
                 <tr>
                    <th>Numéro de capacité</th>
                    <td id="num-capacite"></td>
                </tr>
                <tr>
                    <th>Catégories du permis</th>
                    <td id="categories"></td>
                </tr>
                <tr style="border-bottom: none;">
                    <th style="border-bottom: none;">Date de création</th>
                    <td style="border-bottom: none;" id="date-creation"></td>
                </tr>
            </table>

        </div>
    </div>

    <div class="footer">
        Copyright © 2025 - All rights reserved - MINT - Cameroon
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const apiUrl = "https://www.cartegrisecameroun.com/public/api/getPermisInfo.php";
            const loading = document.getElementById("loading");
            const content = document.getElementById("content");
            
            const params = new URLSearchParams(window.location.search);
            const permisId = params.get('id');

            if (!permisId) {
                loading.innerHTML = '<span style="color:red">Aucun ID fourni.</span>';
                return;
            }

            fetch(apiUrl + '?id=' + permisId)
                .then(res => res.json())
                .then(data => {
                    if (data.success && data.permis) {
                        const p = data.permis;

                        // Remplissage automatique
                        const ids = ['nom', 'prenoms', 'lieu-naissance', 'date-naissance', 'genre', 'nationalite', 'num-permis', 'num-capacite', 'categories', 'date-creation'];
                        ids.forEach(key => {
                            const el = document.getElementById(key);
                            if(el) {
                                const apiKey = key.replace('-', '_');
                                el.textContent = p[apiKey] || p[key] || 'N/A';
                            }
                        });

                        document.getElementById('photo-permis').src = p.photo_url || '';
                        
                        // Statut
                        const stEl = document.getElementById('statut-demande');
                        const stTxt = (p.statut_demande || 'Inconnu');
                        stEl.textContent = stTxt;
                        
                        // Couleurs Statut
                        if(stTxt.toLowerCase().includes('valid') || stTxt.toLowerCase().includes('traitement')) {
                            stEl.className = 'status-text status-valid';
                        } else if(stTxt.toLowerCase().includes('rejet')) {
                            stEl.className = 'status-text status-error';
                        } else {
                            stEl.className = 'status-text status-wait';
                        }

                        loading.style.display = 'none';
                        content.style.display = 'block';
                    } else {
                        loading.innerHTML = '<span style="color:red">Dossier introuvable.</span>';
                    }
                })
                .catch(err => {
                    loading.innerHTML = '<span style="color:red">Erreur de connexion serveur.</span>';
                });
        });
    </script>
</body>
</html>




